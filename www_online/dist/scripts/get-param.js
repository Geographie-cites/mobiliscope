var queryString=window.location.search,urlParams=new URLSearchParams(queryString),url=new URL(location.href),search_params=url.searchParams,m1="",m2="",m3="",m4="",t="",s="";queryString?(m1=urlParams.get("m1"),m2=urlParams.get("m2"),m3=urlParams.get("m3"),m4=urlParams.get("m4"),t=urlParams.get("t"),s=urlParams.get("s"),t&&(slider=d3.slider().value(t),currentFrame=t),s&&(currSect[0]=s),m1&&m2&&m3&&m4?$("#menu .niv1").each((function(e,t){e+1==m1&&($(this).trigger("click"),$(this).nextUntil(".niv1",".niv2").each((function(e,t){e+1==m2&&($(t).click(),$(this).nextUntil(".niv2",".niv3").each((function(e,t){e+1==m3&&$(t).find(".niv-logo button").each((function(e,t){$(t).attr("class")==m4&&$(t).click()}))})))})))})):age2_prop()):age2_prop(),setUrlParam(m1,m2,m3,m4,t,s);var m11="2",m22="1",m33="3",m44="nb";function setUrlParam(e,t,r,a,n,o){search_params.set("m1",e),search_params.set("m2",t),search_params.set("m3",r),search_params.set("m4",a),search_params.set("t",n),search_params.set("s",o),url.search=search_params.toString(),$("#myDropdown a").each((function(){$(this).attr("href",$(this).attr("href").split("?")[0]+"?"+search_params.toString())}));const s={m1:e,m2:t,m3:r,m4:a,t:n,s:o};window.history.pushState(s,document.title,url.search)}function getShareInfo(){var e="Mobiliscope - "+encodeURIComponent($("#city-name h2").html().replace(/<[^>]*>/g,""))+"%0D%0A",t=encodeURIComponent($("#mapTitle").html().replace(/<[^>]*>/g,"").trim())+" "+shareLocalText[0],r=encodeURIComponent(location.href),a=t+"%0D%0A %0D%0A"+r;return{title:e,description:t,pageUrl:r,mailMessage:a,shareMailURL:"mailto:?subject="+e+"&body="+a,shareTWURL:"https://twitter.com/share?title="+e+"&url="+r+"&text="+t,shareFBURL:"https://www.facebook.com/sharer/sharer.php?quote="+e+" %0D%0A %0D%0A "+a+"&u="+r,shareLKURL:"https://www.linkedin.com/sharing/share-offsite/?url="+r+"&title="+e+"&summary="+t}}$("#menu .niv3 button").each((function(e,t){$(t).click((function(){var e,r="",a="",n="1",o=urlParams.get("t"),s=urlParams.get("s");$(t).parents(".niv3").prevUntil(".niv2",".niv3").each((function(e,t){n=e+2})),$(t).parents(".niv3").prevUntil(".niv1",".niv2").each((function(e,t){a=e+1})),$(t).parents(".niv3").prevUntil("#menu",".niv1").each((function(e,t){r=e+1})),e=$(t).attr("class"),o=currentFrame,s=currSect[0],m11=r,m22=a,m33=n,m44=e,setUrlParam(r,a,n,e,o,s)}))})),d3.select("#map-container").on("click",(function(){var e=m11,t=m22,r=m33,a=m44,n=currSect[0];setUrlParam(e,t,r,a,currentFrame,n)})),d3.select(".container-timeline").on("click",(function(){setUrlParam(m11,m22,m33,m44,currentFrame,currSect[0])})),window.Clipboard=function(e,t,r){var a;return{copy:function(n){var o,s;!function(e){(a=t.createElement("textArea")).value=e,t.body.appendChild(a)}(n),r.userAgent.match(/ipad|iphone/i)?((o=t.createRange()).selectNodeContents(a),(s=e.getSelection()).removeAllRanges(),s.addRange(o),a.setSelectionRange(0,999999)):a.select(),t.execCommand("copy"),t.body.removeChild(a)}}}(window,document,navigator),$(document).ready((function(){$("#share-mail").click((function(e){let t=getShareInfo();window.open(t.shareMailURL,"","left=0,top=0,width=550,height=450,personalbar=0,toolbar=0,scrollbars=0,resizable=0")})),$("#share-tw").click((function(e){let t=getShareInfo();window.open(t.shareTWURL,"","left=0,top=0,width=550,height=450,personalbar=0,toolbar=0,scrollbars=0,resizable=0")})),$("#share-fb").click((function(e){let t=getShareInfo();window.open(t.shareFBURL,"","left=0,top=0,width=550,height=450,personalbar=0,toolbar=0,scrollbars=0,resizable=0")})),$("#share-lk").click((function(e){let t=getShareInfo();window.open(t.shareLKURL,"","left=0,top=0,width=550,height=450,personalbar=0,toolbar=0,scrollbars=0,resizable=0")})),$("#share-link").click((function(e){try{Clipboard.copy(location.href),$("#share-link span").html(shareLocalText[1]),setTimeout((function(){$("#share-link span").html(shareLocalText[2])}),2e3)}catch(e){$("#share-link span").html("Sorry your browser is too old for this..."),setTimeout((function(){$("#share-link span").html(shareLocalText[2])}),2e3),console.error(e),window.isSecureContext||console.error("This feature needs secured https protocol")}}))}));
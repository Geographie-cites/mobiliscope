L.Control.Appearance=L.Control.extend({options:{collapsed:!1,position:"topright",label:null,radioCheckbox:!0,layerName:!0,opacity:!1,color:!1,remove:!1,removeIcon:null},initialize:function(e,t,a,l){for(var i in L.Util.setOptions(this,l),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,e)this._addLayer(e[i],i);for(var i in t)this._addLayer(t[i],i,!0,!0);for(var i in a)this._addLayer(a[i],i,!0)},onAdd:function(e){return this._initLayout(),this._update(),this._container},addOverlay:function(e,t){return this._addLayer(e,e.options.name,!0,t),this._map?this._update():this},_onLayerChange:function(e){this._handlingClick||this._update();var t=this._getLayer(Util.stamp(e.target)),a=t.overlay?"add"===e.type?"overlayadd":"overlayremove":"add"===e.type?"baselayerchange":null;a&&this._map.fire(a,t)},expand:function(){L.DomUtil.addClass(this._container,"leaflet-control-layers-expanded"),this._form.style.height=null;var e=this._map.getSize().y-(this._container.offsetTop+50);return e<this._form.clientHeight?(L.DomUtil.addClass(this._form,"leaflet-control-layers-scrollbar"),this._form.style.height=e+"px"):L.DomUtil.removeClass(this._form,"leaflet-control-layers-scrollbar"),this},collapse:function(){return L.DomUtil.removeClass(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var e="leaflet-control-layers",t=this._container=L.DomUtil.create("div",e),a=this.options.collapsed;if(t.setAttribute("aria-haspopup",!0),L.DomEvent.disableClickPropagation(t),L.DomEvent.disableScrollPropagation(t),this.options.label){var l=L.DomUtil.create("p",e+"-label");l.innerHTML=this.options.label,t.appendChild(l)}var i=this._form=L.DomUtil.create("form",e+"-list");a&&(L.Browser.android||L.DomEvent.on(t,{mouseenter:this.expand,mouseleave:this.collapse},this)),a||this.expand(),this._baseLayersList=L.DomUtil.create("div",e+"-base",i),this._separator=L.DomUtil.create("div",e+"-separator",i),this._overlaysList=L.DomUtil.create("div",e+"-overlays",i),t.appendChild(i)},_update:function(){if(!this._container)return this;var e,t,a,l;for(L.DomUtil.empty(this._baseLayersList),L.DomUtil.empty(this._overlaysList),this._layerControlInputs=[],a=0;a<this._layers.length;a++)l=this._layers[a],this._addItem(l),t=t||l.overlay,e=e||!l.overlay,l.overlay;return this._separator.style.display=t&&e?"":"none",this},_getLayer:function(e){for(var t=0;t<this._layers.length;t++)if(this._layers[t]&&L.Util.stamp(this._layers[t].layer)===e)return this._layers[t]},_addLayer:function(e,t,a,l){this._layers.push({layer:e,name:t,overlay:a,uneditable:l})},_removeLayer:function(e){for(var t=0;t<this._layers.length;t++)if(this._layers[t]&&L.Util.stamp(this._layers[t].layer)===e){this._layers.splice(t,1);break}},_addItem:function(e){var t=document.createElement("label"),a=this._map.hasLayer(e.layer),l=e.name;opacity=e.layer.options.opacity,color=e.layer.options.color,elements=[],e.overlay?(this.options.radioCheckbox&&elements.push(this._createCheckboxElement("leaflet-control-layers-selector",a)),this.options.layerName&&elements.push(this._createNameElement("leaflet-control-layers-name",l)),this.options.opacity&&elements.push(this._createRangeElement("leaflet-control-layers-range",opacity)),this.options.color&&!e.uneditable&&elements.push(this._createColorElement("leaflet-control-layers-color",color)),this.options.remove&&!e.uneditable&&elements.push(this._createRemoveElement("leaflet-control-layers-remove"))):(this.options.radioCheckbox&&elements.push(this._createRadioElement("leaflet-control-layers-selector",a)),this.options.layerName&&elements.push(this._createNameElement("leaflet-control-layers-name",l)));var i=document.createElement("div");i.style="display: flex; align-items: baseline;",t.appendChild(i);for(var n=0;n<elements.length;n++)if(i.appendChild(elements[n]),1!=n)switch(this._layerControlInputs.push(elements[n]),elements[n].layerId=L.Util.stamp(e.layer),elements[n].className){case"leaflet-control-layers-range":L.DomEvent.on(elements[n],"change",this._onRangeClick,this);break;case"leaflet-control-layers-selector":L.DomEvent.on(elements[n],"change",this._onRadioCheckboxClick,this);break;case"leaflet-control-layers-color":L.DomEvent.on(elements[n],"change",this._onColorClick,this);break;case"leaflet-control-layers-remove":L.DomEvent.on(elements[n],"change",this._onRemoveClick,this)}return(e.overlay?this._overlaysList:this._baseLayersList).appendChild(t),t},_createRadioElement:function(e,t){var a='<input type="radio" class="leaflet-control-layers-selector" name="'+e+'"'+(t?' checked="checked"':"")+"/>",l=document.createElement("div");return l.innerHTML=a,l.firstChild},_createCheckboxElement:function(e,t){return input=document.createElement("input"),input.type="checkbox",input.className=e,input.defaultChecked=t,input},_createNameElement:function(e,t){var a=document.createElement("span");return a.style.display="inline-block",a.style.width="100px",a.style.margin="0 5 0 5",a.style.overflow="hidden",a.style.verticalAlign="middle",a.innerHTML=" "+t,a},_createRangeElement:function(e,t){return input=document.createElement("input"),input.type="range",input.style.width="50px",input.className=e,input.min=0,input.max=100,input.value=100*t,input},_createColorElement:function(e,t){var a='<input type="color" class="leaflet-control-layers-color" value="'+t+'"list="data1"/ style="width:50px; margin:0 5 0 5;">',l=document.createElement("div");return l.innerHTML=a,l.firstChild},_createRemoveElement:function(e,t){return input=document.createElement("input"),input.type="checkbox",input.className=e,input.defaultChecked=!0,(t=this.options.removeIcon)&&(input.style="-webkit-appearance:none; background:url("+t+"); width:1rem; height:1rem; background-size: contain;"),input},_onRadioCheckboxClick:function(){var e,t,a=this._layerControlInputs,l=[],i=[];this._handlingClick=!0;for(var n=0;n<a.length;n++)"leaflet-control-layers-selector"==(e=a[n]).className&&(t=this._getLayer(e.layerId).layer,e.checked?this._map.addLayer(t):e.checked||this._map.removeLayer(t));for(n=0;n<i.length;n++)this._map.hasLayer(i[n])&&this._map.removeLayer(i[n]);for(n=0;n<l.length;n++)this._map.hasLayer(l[n])||this._map.addLayer(l[n]);this._handlingClick=!1,this._refocusOnMap()},_onRangeClick:function(){var e,t,a=this._layerControlInputs;this._handlingClick=!0;for(var l=a.length-1;l>=0;l--)if("leaflet-control-layers-range"==(e=a[l]).className)if(void 0===(t=this._getLayer(e.layerId).layer)._url){var i=parseFloat(parseInt(e.value/10)/10),n={opacity:i,fillOpacity:i/2};t.setStyle(n),t.options.opacity=i,t.options.fillOpacity=i/2}else t.setOpacity(e.value/100);this._handlingClick=!1,this._refocusOnMap()},_onColorClick:function(){var e,t,a=this._layerControlInputs;this._handlingClick=!0;for(var l=0;l<a.length;l++)if("leaflet-control-layers-color"==(e=a[l]).className&&void 0===(t=this._getLayer(e.layerId).layer)._url){var i={color:e.value,opacity:t.options.opacity,fillOpacity:t.options.fillOpacity};t.setStyle(i),t.options.color=e.value}this._handlingClick=!1,this._update(),this._refocusOnMap()},_onRemoveClick:function(){var e,t,a=this._layerControlInputs;this._handlingClick=!0;for(var l=0;l<a.length;l++)if("leaflet-control-layers-remove"==(e=a[l]).className&&!e.checked){t=this._getLayer(e.layerId).layer,this._map.removeLayer(t),this._removeLayer(e.layerId);break}this._handlingClick=!1,this._update(),this._refocusOnMap()}}),L.control.appearance=function(e,t,a,l){return new L.Control.Appearance(e,t,a,l)};